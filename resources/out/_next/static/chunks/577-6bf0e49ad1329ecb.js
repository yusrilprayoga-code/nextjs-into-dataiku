"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{255:(e,t,a)=>{function r(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return r}}),a(5155),a(7650),a(5744),a(589)},1154:(e,t,a)=>{a.d(t,{A:()=>r});let r=(0,a(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2146:(e,t,a)=>{function r(e){let{reason:t,children:a}=e;return a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}}),a(5262)},2577:(e,t,a)=>{a.d(t,{M:()=>u,q:()=>c});var r=a(5155),l=a(8335),s=a(5695),o=a(2115),n=a(9509);let i=(0,o.createContext)(void 0),c=e=>{let{children:t}=e,[a,c]=(0,o.useState)([]),[u,d]=(0,o.useState)([]),[f,p]=(0,o.useState)([]),[h,g]=(0,o.useState)([]),[m,b]=(0,o.useState)([]),[y,w]=(0,o.useState)([]),[v,_]=(0,o.useState)({}),[P,S]=(0,o.useState)([]),[j,k]=(0,o.useState)("default"),[x,N]=(0,o.useState)(null),[O,E]=(0,o.useState)({data:[],layout:{}}),[C,R]=(0,o.useState)(!1),[A,D]=(0,o.useState)(null),[z,L]=(0,o.useState)(null),I=n.env.NEXT_PUBLIC_API_URL,F=(0,s.usePathname)().startsWith("/data-prep"),{wellsDir:T}=(0,l.m)(),M=(0,o.useRef)(new Set),q=(0,o.useRef)(new Set);(0,o.useEffect)(()=>{(async()=>{if(F||!T){c([]),d([]),p([]);return}try{if(!I)throw Error("API URL is not configured.");let e=await fetch("".concat(I,"/api/list-wells"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_path:T})});if(!e.ok)throw Error("Failed to fetch well list");let t=await e.json();Array.isArray(t)&&c(t)}catch(e){console.error("Failed to fetch well list:",e)}try{let e=await fetch("".concat(I,"/api/list-intervals"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_path:T})});if(e.ok){let t=await e.json();Array.isArray(t)&&d(t)}}catch(e){console.error("Error fetching intervals:",e)}try{let e=await fetch("".concat(I,"/api/list-zones"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_path:T})});if(!e.ok)throw Error("Failed to fetch zone list");let t=await e.json();Array.isArray(t)&&p(t)}catch(e){console.error("Error fetching zones:",e)}})()},[I,F,T]);let W=(0,o.useCallback)(async e=>{let t;if(!I)return void console.warn("API URL not set, cannot fetch well columns");let a=e.filter(e=>!M.current.has(e)&&!q.current.has(e));if(0!==a.length){if(F)t={wells:a};else{if(!T)return void console.warn("wellsDir is not set; cannot fetch columns for dashboard.");t={full_path:T,wells:a}}a.forEach(e=>q.current.add(e)),L(null);try{let e=await fetch("".concat(I,"/api/get-well-columns"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw Error("Server responded with status: ".concat(e.status));let r=await e.json();if("object"!=typeof r||null===r||0===Object.keys(r).length)throw Error("API returned empty or invalid data for well columns.");_(e=>({...e,...r})),a.forEach(e=>{M.current.add(e),q.current.delete(e)})}catch(t){a.forEach(e=>q.current.delete(e));let e=t instanceof Error?t.message:"An unknown error occurred";L("Failed to load curves: ".concat(e)),console.error("Failed to fetch well columns:",t)}}},[I,F,T]);(0,o.useEffect)(()=>{if(0===h.length){_({}),L(null),M.current.clear(),q.current.clear();return}W(h)},[h,W]);let U=(0,o.useCallback)(async()=>{let e;R(!0),D(null),E({data:[],layout:{}});let t=!!x;if(!t&&0===h.length){E({data:[],layout:{title:{text:"Please select a well from the list."}}}),R(!1);return}if(t&&!x){E({data:[],layout:{title:{text:"Please select a file from the browser."}}}),R(!1);return}let a="";if(t){switch(j){case"normalization-prep":a="/api/get-normalization-prep-plot";break;case"smoothing-prep":a="/api/get-smoothing-prep-plot";break;case"splicing":a="/api/get-splicing-plot";break;case"custom":a="/api/get-custom-plot";break;default:a="/api/get-module1-plot"}e="custom"===j?{custom_columns:P,file_path:x}:{file_path:x}}else{switch(j){case"normalization":a="/api/get-normalization-plot";break;case"smoothing":a="/api/get-smoothing-plot";break;case"splicing":a="/api/get-splicing-plot";break;case"porosity":a="/api/get-porosity-plot";break;case"gsa":a="/api/get-gsa-plot";break;case"vsh":a="/api/get-vsh-plot";break;case"sw":a="/api/get-sw-plot";break;case"rwa":a="/api/get-rwa-plot";break;case"module2":a="/api/get-module2-plot";break;case"rpbe-rgbe":a="/api/get-rgbe-rpbe-plot";break;case"iqual":a="/api/get-iqual";break;case"swgrad":a="/api/get-swgrad-plot";break;case"dns-dnsv":a="/api/get-dns-dnsv-plot";break;case"rt-ro":a="/api/get-rt-r0-plot";break;case"module3":a="/api/get-module3-plot";break;case"custom":a="/api/get-custom-plot";break;default:a="/api/get-plot"}e="custom"===j?{custom_columns:P,selected_wells:h,selected_intervals:m,selected_zones:y,full_path:T}:{selected_wells:h,selected_intervals:m,selected_zones:y,full_path:T}}try{let t=await fetch("".concat(I).concat(a),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to fetch plot from server");let r=await t.json(),l="string"==typeof r?JSON.parse(r):r;if(l&&(l.data||l.layout))E({data:l.data||[],layout:l.layout||{}});else throw Error("Invalid plot data structure received from server.")}catch(e){console.error('Error fetching plot for type "'.concat(j,'":'),e),D(e instanceof Error?e.message:"An unknown error occurred")}finally{R(!1)}},[I,j,x,h,m,y,P,T,F]);return(0,r.jsx)(i.Provider,{value:{availableWells:a,selectedWells:h,toggleWellSelection:e=>{g(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},availableIntervals:u,selectedIntervals:m,toggleInterval:e=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},availableZones:f,selectedZones:y,toggleZone:e=>{w(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},wellColumns:v,plotType:j,setPlotType:k,plotFigure:O,setPlotFigure:E,selectedFilePath:x,setSelectedFilePath:N,fetchWellColumns:W,isLoadingPlot:C,plotError:A,fetchPlotData:U,selectedCustomColumns:P,toggleCustomColumn:e=>{S(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},columnError:z},children:t})},u=()=>{let e=(0,o.useContext)(i);if(void 0===e)throw Error("useDashboard must be used within a DashboardProvider");return e}},4054:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{bindSnapshot:function(){return o},createAsyncLocalStorage:function(){return s},createSnapshot:function(){return n}});let a=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class r{disable(){throw a}getStore(){}run(){throw a}exit(){throw a}enterWith(){throw a}static bind(e){return e}}let l="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function s(){return l?new l:new r}function o(e){return l?l.bind(e):r.bind(e)}function n(){return l?l.snapshot():function(e,...t){return e(...t)}}},5028:(e,t,a)=>{a.d(t,{default:()=>l.a});var r=a(6645),l=a.n(r)},5695:(e,t,a)=>{var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},5744:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return r.workAsyncStorageInstance}});let r=a(7828)},6577:(e,t,a)=>{a.d(t,{A:()=>i});var r=a(5155);a(2115);var l=a(5028),s=a(2577),o=a(1154);let n=(0,l.default)(()=>Promise.all([a.e(840),a.e(134),a.e(133)]).then(a.bind(a,1514)),{loadableGenerated:{webpack:()=>[1514]},ssr:!1});function i(){let{plotFigure:e,isLoadingPlot:t,plotError:a}=(0,s.M)();return t?(0,r.jsxs)("div",{className:"flex h-full w-full items-center justify-center text-gray-500",children:[(0,r.jsx)(o.A,{className:"mr-2 h-8 w-8 animate-spin"}),(0,r.jsx)("span",{children:"Loading Plot from Server..."})]}):a?(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center p-4",children:(0,r.jsxs)("p",{className:"text-center text-red-600 bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,r.jsx)("strong",{children:"Error:"})," ",a]})}):e&&e.data&&0!==e.data.length?(0,r.jsx)("div",{style:{border:"1px solid #ccc",padding:"1rem",background:"white",borderRadius:"8px",height:"100%",width:"100%"},children:(0,r.jsx)(n,{data:e.data,layout:e.layout,style:{width:"100%",height:"100%"},config:{responsive:!0,displaylogo:!1}})}):(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center text-center text-gray-500 p-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"No Plot to Display"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:"Please select a well or file from a sidebar to generate a plot."})]})})}},6645:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=a(8229)._(a(7357));function l(e,t){var a;let l={};"function"==typeof e&&(l.loader=e);let s={...l,...t};return(0,r.default)({...s,modules:null==(a=s.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7357:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let r=a(5155),l=a(2115),s=a(2146);function o(e){return{default:e&&"default"in e?e.default:e}}a(255);let n={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},i=function(e){let t={...n,...e},a=(0,l.lazy)(()=>t.loader().then(o)),i=t.loading;function c(e){let o=i?(0,r.jsx)(i,{isLoading:!0,pastDelay:!0,error:null}):null,n=!t.ssr||!!t.loading,c=n?l.Suspense:l.Fragment,u=t.ssr?(0,r.jsxs)(r.Fragment,{children:[null,(0,r.jsx)(a,{...e})]}):(0,r.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(c,{...n?{fallback:o}:{},children:u})}return c.displayName="LoadableComponent",c}},7828:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return r}});let r=(0,a(4054).createAsyncLocalStorage)()},8335:(e,t,a)=>{a.d(t,{m:()=>s});var r=a(5453),l=a(6786);let s=(0,r.v)()((0,l.Zr)((e,t)=>({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},selectedWell:"",selectedIntervals:[],plotData:[],plotLayout:{},isLoadingPlot:!0,plotError:null,vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5},wellsDir:"data/structures/adera/benuang",fieldName:"adera",structureName:"benuang",wellFolder:"BNG-057",setWellsDir:t=>{console.log("Updating wellsDir to: ".concat(t)),e({wellsDir:t})},setStructure:(t,a,r)=>{let l="data/structures/".concat(t.toLowerCase(),"/").concat(a.toLowerCase());console.log("Updating structure settings:\n          fieldName: ".concat(t.toLowerCase(),"\n          structureName: ").concat(a.toLowerCase(),"\n          wellFolder: ").concat(r.toLowerCase(),"\n          wellsDir: ").concat(l)),e({fieldName:t.toLowerCase(),structureName:a.toLowerCase(),wellFolder:r.toLowerCase(),wellsDir:l})},setStagedStructure:t=>e({stagedStructure:t}),setQcResults:t=>e({qcResults:t}),addHandledFile:t=>e(e=>({handledFiles:[...e.handledFiles,t]})),addNormalizationResult:(t,a)=>e(e=>({normalizationResults:{...e.normalizationResults,[t]:a}})),clearQcResults:()=>e({qcResults:null,handledFiles:[]}),clearNormalizationResults:()=>e({normalizationResults:{}}),clearAllData:()=>e({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5}}),setSelectedWell:a=>{e({selectedWell:a}),t().fetchPlotData(a)},toggleInterval:t=>e(e=>({selectedIntervals:e.selectedIntervals.includes(t)?e.selectedIntervals.filter(e=>e!==t):[...e.selectedIntervals,t]})),setVshParams:t=>e({vshParams:t}),setVshDNParams:t=>e({vshDNParams:t}),fetchPlotData:async e=>{}}),{name:"app-data-storage",partialize:e=>({selectedWell:e.selectedWell,selectedIntervals:e.selectedIntervals,vshParams:e.vshParams,vshDNParams:e.vshDNParams}),storage:(0,l.KU)(()=>localStorage)}))}}]);