"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[723],{1713:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(5155);function s(e){let{children:t}=e;return(0,r.jsx)("main",{className:"flex-1 relative overflow-y-auto bg-gray-100 p-4 h-screen",children:t})}a(2115)},2431:(e,t,a)=>{a.d(t,{A:()=>h});var r=a(5155),s=a(2115),l=a(6874),o=a.n(l),n=a(5695),c=a(6474),i=a(3052);let u=e=>{switch(e){case"HISTOGRAM":return"histogram";case"CROSSPLOT":return"crossplot";case"VSH-GR":return"vsh-calculation";case"VSH-DN":return"vsh-dn-calculation";case"SW INDONESIA":return"sw-calculation";case"SW SIMANDOUX":return"sw-simandoux";case"RGSA":return"rgsa";case"DGSA":return"dgsa";case"NGSA":return"ngsa";case"TRIM DATA":return"trim-data";case"DEPTH MATCHING":return"depth-matching";case"FILL MISSING":return"fill-missing";case"SMOOTHING":return"smoothing";case"NORMALIZATION":return"normalization";case"SPLICING/MERGING":return"splicing-merging";case"POROSITY CALCULATION":return"porosity-calculation";case"WATER RESISTIVITY CALCULATION":return"water-resistivity-calculation";case"RGBE-RPBE":return"rgbe-rpbe";case"AUTO FLUID":return"auto-fluid";case"RT RO":return"rt-ro";case"SWGRAD":return"swgrad";case"DNS-DNSV":return"dns-dnsv";case"GWD":return"gwd";default:return e.toLowerCase().replace(/\s+/g,"-")}},d=e=>{let{title:t,buttons:a,activeButton:l,routePrefix:n}=e,[d,h]=(0,s.useState)(new Set),p=e=>{let t=new Set(d);t.has(e)?t.delete(e):t.add(e),h(t)};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-2",children:[t&&(0,r.jsx)("h3",{className:"text-xs font-bold text-gray-700 mb-1",children:t}),(0,r.jsx)("div",{className:"flex flex-col gap-1",children:a.map(e=>{if("string"==typeof e){let t=u(e),a="".concat(n,"/").concat(t),s=l===t;return(0,r.jsx)(o(),{href:a,children:(0,r.jsx)("button",{className:"w-full text-xs font-medium text-left p-1 rounded border transition-colors duration-200 ".concat(s?"bg-gray-700 text-white border-gray-800":"text-black bg-gray-200 border-gray-300 hover:bg-gray-300"),children:e})},e)}{let t=d.has(e.label);return(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsxs)("button",{onClick:()=>p(e.label),className:"w-full text-xs font-medium text-left p-1 rounded border transition-colors duration-200 text-black bg-gray-200 border-gray-300 hover:bg-gray-300 flex items-center justify-between",children:[(0,r.jsx)("span",{children:e.label}),t?(0,r.jsx)(c.A,{className:"w-3 h-3"}):(0,r.jsx)(i.A,{className:"w-3 h-3"})]}),t&&(0,r.jsx)("div",{className:"ml-2 space-y-0.5",children:e.items.map(e=>{let t=u(e),a="".concat(n,"/").concat(t),s=l===t;return(0,r.jsx)(o(),{href:a,children:(0,r.jsx)("button",{className:"w-full text-xs font-normal text-left p-1 rounded border transition-colors duration-200 ".concat(s?"bg-gray-700 text-white border-gray-800":"text-gray-700 bg-gray-100 border-gray-200 hover:bg-gray-200"),children:e})},e)})})]},e.label)}})})]})},h=e=>{let{activeButton:t}=e,a=(0,n.usePathname)().startsWith("/data-prep"),s=a?"/data-prep/modules":"/dashboard/modules";return(0,r.jsxs)("aside",{className:"w-52 bg-gray-100 flex flex-col gap-2 p-2 border-l border-gray-300 overflow-y-auto h-screen",children:[(0,r.jsx)("div",{className:"text-xs font-bold text-gray-800 px-2 py-1",children:a?"Data Preparation":"Module Configuration"}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:a?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d,{title:"Data Preparation",buttons:["TRIM DATA","DEPTH MATCHING","FILL MISSING","SMOOTHING","NORMALIZATION","SPLICING/MERGING"],activeButton:t,routePrefix:s})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{title:"Data Preparation",buttons:["TRIM DATA","DEPTH MATCHING","FILL MISSING","SMOOTHING","NORMALIZATION","SPLICING/MERGING"],activeButton:t,routePrefix:s}),(0,r.jsx)(d,{title:"Interpretation",buttons:[{label:"VSH CALCULATION",items:["VSH-GR","VSH-DN"]},"POROSITY CALCULATION",{label:"SW CALCULATION",items:["SW INDONESIA","SW SIMANDOUX"]},"WATER RESISTIVITY CALCULATION"],activeButton:t,routePrefix:s}),(0,r.jsx)(d,{title:"Gas Oil Water Scanner (GOWS)",buttons:[{label:"GSA",items:["RGSA","DGSA","NGSA"]},"RGBE-RPBE","AUTO FLUID","RT RO","SWGRAD","DNS-DNSV","GWD"],activeButton:t,routePrefix:s})]})})]})}},2577:(e,t,a)=>{a.d(t,{M:()=>u,q:()=>i});var r=a(5155),s=a(8335),l=a(5695),o=a(2115),n=a(9509);let c=(0,o.createContext)(void 0),i=e=>{let{children:t}=e,[a,i]=(0,o.useState)([]),[u,d]=(0,o.useState)([]),[h,p]=(0,o.useState)([]),[g,m]=(0,o.useState)([]),[f,w]=(0,o.useState)([]),[b,S]=(0,o.useState)([]),[N,y]=(0,o.useState)({}),[I,v]=(0,o.useState)([]),[x,A]=(0,o.useState)("default"),[P,R]=(0,o.useState)(null),[T,O]=(0,o.useState)({data:[],layout:{}}),[D,C]=(0,o.useState)(!1),[L,_]=(0,o.useState)(null),[j,E]=(0,o.useState)(null),k=n.env.NEXT_PUBLIC_API_URL,G=(0,l.usePathname)().startsWith("/data-prep"),{wellsDir:M}=(0,s.m)(),F=(0,o.useRef)(new Set),W=(0,o.useRef)(new Set);(0,o.useEffect)(()=>{(async()=>{if(G||!M){i([]),d([]),p([]);return}try{if(!k)throw Error("API URL is not configured.");let e=await fetch("".concat(k,"/api/list-wells"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_path:M})});if(!e.ok)throw Error("Failed to fetch well list");let t=await e.json();Array.isArray(t)&&i(t)}catch(e){console.error("Failed to fetch well list:",e)}try{let e=await fetch("".concat(k,"/api/list-intervals"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_path:M})});if(e.ok){let t=await e.json();Array.isArray(t)&&d(t)}}catch(e){console.error("Error fetching intervals:",e)}try{let e=await fetch("".concat(k,"/api/list-zones"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_path:M})});if(!e.ok)throw Error("Failed to fetch zone list");let t=await e.json();Array.isArray(t)&&p(t)}catch(e){console.error("Error fetching zones:",e)}})()},[k,G,M]);let z=(0,o.useCallback)(async e=>{let t;if(!k)return void console.warn("API URL not set, cannot fetch well columns");let a=e.filter(e=>!F.current.has(e)&&!W.current.has(e));if(0!==a.length){if(G)t={wells:a};else{if(!M)return void console.warn("wellsDir is not set; cannot fetch columns for dashboard.");t={full_path:M,wells:a}}a.forEach(e=>W.current.add(e)),E(null);try{let e=await fetch("".concat(k,"/api/get-well-columns"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw Error("Server responded with status: ".concat(e.status));let r=await e.json();if("object"!=typeof r||null===r||0===Object.keys(r).length)throw Error("API returned empty or invalid data for well columns.");y(e=>({...e,...r})),a.forEach(e=>{F.current.add(e),W.current.delete(e)})}catch(t){a.forEach(e=>W.current.delete(e));let e=t instanceof Error?t.message:"An unknown error occurred";E("Failed to load curves: ".concat(e)),console.error("Failed to fetch well columns:",t)}}},[k,G,M]);(0,o.useEffect)(()=>{if(0===g.length){y({}),E(null),F.current.clear(),W.current.clear();return}z(g)},[g,z]);let U=(0,o.useCallback)(async()=>{let e;C(!0),_(null),O({data:[],layout:{}});let t=!!P;if(!t&&0===g.length){O({data:[],layout:{title:{text:"Please select a well from the list."}}}),C(!1);return}if(t&&!P){O({data:[],layout:{title:{text:"Please select a file from the browser."}}}),C(!1);return}let a="";if(t){switch(x){case"normalization-prep":a="/api/get-normalization-prep-plot";break;case"smoothing-prep":a="/api/get-smoothing-prep-plot";break;case"splicing":a="/api/get-splicing-plot";break;case"custom":a="/api/get-custom-plot";break;default:a="/api/get-module1-plot"}e="custom"===x?{custom_columns:I,file_path:P}:{file_path:P}}else{switch(x){case"normalization":a="/api/get-normalization-plot";break;case"smoothing":a="/api/get-smoothing-plot";break;case"splicing":a="/api/get-splicing-plot";break;case"porosity":a="/api/get-porosity-plot";break;case"gsa":a="/api/get-gsa-plot";break;case"vsh":a="/api/get-vsh-plot";break;case"sw":a="/api/get-sw-plot";break;case"rwa":a="/api/get-rwa-plot";break;case"module2":a="/api/get-module2-plot";break;case"rpbe-rgbe":a="/api/get-rgbe-rpbe-plot";break;case"iqual":a="/api/get-iqual";break;case"swgrad":a="/api/get-swgrad-plot";break;case"dns-dnsv":a="/api/get-dns-dnsv-plot";break;case"rt-ro":a="/api/get-rt-r0-plot";break;case"module3":a="/api/get-module3-plot";break;case"custom":a="/api/get-custom-plot";break;default:a="/api/get-plot"}e="custom"===x?{custom_columns:I,selected_wells:g,selected_intervals:f,selected_zones:b,full_path:M}:{selected_wells:g,selected_intervals:f,selected_zones:b,full_path:M}}try{let t=await fetch("".concat(k).concat(a),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to fetch plot from server");let r=await t.json(),s="string"==typeof r?JSON.parse(r):r;if(s&&(s.data||s.layout))O({data:s.data||[],layout:s.layout||{}});else throw Error("Invalid plot data structure received from server.")}catch(e){console.error('Error fetching plot for type "'.concat(x,'":'),e),_(e instanceof Error?e.message:"An unknown error occurred")}finally{C(!1)}},[k,x,P,g,f,b,I,M,G]);return(0,r.jsx)(c.Provider,{value:{availableWells:a,selectedWells:g,toggleWellSelection:e=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},availableIntervals:u,selectedIntervals:f,toggleInterval:e=>{w(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},availableZones:h,selectedZones:b,toggleZone:e=>{S(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},wellColumns:N,plotType:x,setPlotType:A,plotFigure:T,setPlotFigure:O,selectedFilePath:P,setSelectedFilePath:R,fetchWellColumns:z,isLoadingPlot:D,plotError:L,fetchPlotData:U,selectedCustomColumns:I,toggleCustomColumn:e=>{v(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},columnError:j},children:t})},u=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useDashboard must be used within a DashboardProvider");return e}},8335:(e,t,a)=>{a.d(t,{m:()=>l});var r=a(5453),s=a(6786);let l=(0,r.v)()((0,s.Zr)((e,t)=>({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},selectedWell:"",selectedIntervals:[],plotData:[],plotLayout:{},isLoadingPlot:!0,plotError:null,vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5},wellsDir:"data/structures/adera/benuang",fieldName:"adera",structureName:"benuang",wellFolder:"BNG-057",setWellsDir:t=>{console.log("Updating wellsDir to: ".concat(t)),e({wellsDir:t})},setStructure:(t,a,r)=>{let s="data/structures/".concat(t.toLowerCase(),"/").concat(a.toLowerCase());console.log("Updating structure settings:\n          fieldName: ".concat(t.toLowerCase(),"\n          structureName: ").concat(a.toLowerCase(),"\n          wellFolder: ").concat(r.toLowerCase(),"\n          wellsDir: ").concat(s)),e({fieldName:t.toLowerCase(),structureName:a.toLowerCase(),wellFolder:r.toLowerCase(),wellsDir:s})},setStagedStructure:t=>e({stagedStructure:t}),setQcResults:t=>e({qcResults:t}),addHandledFile:t=>e(e=>({handledFiles:[...e.handledFiles,t]})),addNormalizationResult:(t,a)=>e(e=>({normalizationResults:{...e.normalizationResults,[t]:a}})),clearQcResults:()=>e({qcResults:null,handledFiles:[]}),clearNormalizationResults:()=>e({normalizationResults:{}}),clearAllData:()=>e({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5}}),setSelectedWell:a=>{e({selectedWell:a}),t().fetchPlotData(a)},toggleInterval:t=>e(e=>({selectedIntervals:e.selectedIntervals.includes(t)?e.selectedIntervals.filter(e=>e!==t):[...e.selectedIntervals,t]})),setVshParams:t=>e({vshParams:t}),setVshDNParams:t=>e({vshDNParams:t}),fetchPlotData:async e=>{}}),{name:"app-data-storage",partialize:e=>({selectedWell:e.selectedWell,selectedIntervals:e.selectedIntervals,vshParams:e.vshParams,vshDNParams:e.vshDNParams}),storage:(0,s.KU)(()=>localStorage)}))}}]);