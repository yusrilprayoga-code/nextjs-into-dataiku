(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{1154:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2975:(e,a,s)=>{"use strict";s.d(a,{default:()=>o});var t=s(5155),l=s(8335),r=s(1154);let n=(0,s(9946).A)("circle-play",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);var i=s(2115);function o(){let{stagedStructure:e,setQcResults:a}=(0,l.m)(),[s,o]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null),[u,m]=(0,i.useState)(null),h=async()=>{if(!e||0===e.files.length)return void alert("Tidak ada data yang siap untuk diproses. Silakan upload file terlebih dahulu.");o(!0),m(null),d(null);try{let s=e.files.map(e=>({name:e.originalName||e.name,content:e.rawContentString})),t=await fetch("/api/qc/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:s})});if(!t.ok){let e=await t.json().catch(()=>({error:"Server error"}));throw Error(e.error||"HTTP error! Status: ".concat(t.status))}let l=await t.json();d(l),a(l)}catch(a){let e=a instanceof Error?a.message:"Terjadi kesalahan tidak dikenal";console.error("Gagal menjalankan QC:",a),m(e)}finally{o(!1)}};return(0,t.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Quality Control Runner"}),e?(0,t.jsxs)("div",{className:"mb-4 p-4 bg-gray-50 rounded-md border",children:[(0,t.jsx)("p",{className:"font-semibold text-gray-700",children:"Struktur Siap Diproses:"}),(0,t.jsx)("p",{className:"text-lg font-bold text-blue-600",children:e.userDefinedStructureName}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[e.files.length," file akan diproses."]})]}):(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"Silakan kembali ke halaman upload dan siapkan data terlebih dahulu."}),(0,t.jsxs)("button",{onClick:h,disabled:s||!e,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-green-500 text-white font-bold rounded-md hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:[s?(0,t.jsx)(r.A,{className:"w-5 h-5 animate-spin"}):(0,t.jsx)(n,{className:"w-5 h-5"}),s?"Sedang Memproses...":"Jalankan Quality Control"]}),u&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-red-100 text-red-700 rounded-md text-sm",children:[(0,t.jsx)("strong",{children:"Error:"})," ",u]}),c&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h3",{className:"font-bold text-lg",children:"Hasil QC:"}),(0,t.jsx)("ul",{className:"mt-2 list-disc list-inside space-y-1",children:c.qc_summary.map(e=>(0,t.jsxs)("li",{children:[(0,t.jsxs)("strong",{children:[e.well_name,":"]}),(0,t.jsx)("span",{className:"font-semibold ml-2 ".concat("PASS"===e.status?"text-green-600":"text-yellow-600"),children:e.status}),"- ",(0,t.jsx)("span",{className:"text-gray-600",children:e.details})]},e.well_name))})]})]})}},7763:(e,a,s)=>{Promise.resolve().then(s.bind(s,2975))},8335:(e,a,s)=>{"use strict";s.d(a,{m:()=>r});var t=s(5453),l=s(6786);let r=(0,t.v)()((0,l.Zr)((e,a)=>({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},selectedWell:"",selectedIntervals:[],plotData:[],plotLayout:{},isLoadingPlot:!0,plotError:null,vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5},wellsDir:"data/structures/adera/benuang",fieldName:"adera",structureName:"benuang",wellFolder:"BNG-057",setWellsDir:a=>{console.log("Updating wellsDir to: ".concat(a)),e({wellsDir:a})},setStructure:(a,s,t)=>{let l="data/structures/".concat(a.toLowerCase(),"/").concat(s.toLowerCase());console.log("Updating structure settings:\n          fieldName: ".concat(a.toLowerCase(),"\n          structureName: ").concat(s.toLowerCase(),"\n          wellFolder: ").concat(t.toLowerCase(),"\n          wellsDir: ").concat(l)),e({fieldName:a.toLowerCase(),structureName:s.toLowerCase(),wellFolder:t.toLowerCase(),wellsDir:l})},setStagedStructure:a=>e({stagedStructure:a}),setQcResults:a=>e({qcResults:a}),addHandledFile:a=>e(e=>({handledFiles:[...e.handledFiles,a]})),addNormalizationResult:(a,s)=>e(e=>({normalizationResults:{...e.normalizationResults,[a]:s}})),clearQcResults:()=>e({qcResults:null,handledFiles:[]}),clearNormalizationResults:()=>e({normalizationResults:{}}),clearAllData:()=>e({stagedStructure:null,qcResults:null,handledFiles:[],normalizationResults:{},vshParams:{gr_ma:30,gr_sh:120},vshDNParams:{rhob_ma:2.645,rhob_sh:2.61,nphi_ma:-.02,nphi_sh:.398,prcnt_qz:5,prcnt_wtr:5}}),setSelectedWell:s=>{e({selectedWell:s}),a().fetchPlotData(s)},toggleInterval:a=>e(e=>({selectedIntervals:e.selectedIntervals.includes(a)?e.selectedIntervals.filter(e=>e!==a):[...e.selectedIntervals,a]})),setVshParams:a=>e({vshParams:a}),setVshDNParams:a=>e({vshDNParams:a}),fetchPlotData:async e=>{}}),{name:"app-data-storage",partialize:e=>({selectedWell:e.selectedWell,selectedIntervals:e.selectedIntervals,vshParams:e.vshParams,vshDNParams:e.vshDNParams}),storage:(0,l.KU)(()=>localStorage)}))}},e=>{var a=a=>e(e.s=a);e.O(0,[9,441,684,358],()=>a(7763)),_N_E=e.O()}]);