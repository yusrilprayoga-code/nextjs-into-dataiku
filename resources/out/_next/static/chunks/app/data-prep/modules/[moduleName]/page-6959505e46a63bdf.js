(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{2874:(e,t,a)=>{Promise.resolve().then(a.bind(a,3882))},3882:(e,t,a)=>{"use strict";a.d(t,{default:()=>N});var l=a(5155),s=a(2115),n=a(1243),r=a(5695),o=a(1154),i=a(8335),c=a(9509);let d=()=>{let e=e=>({default:e}),t={NORMALIZE_OPT:"MIN-MAX",LOG_IN:"DGRCC",LOG_OUT:"DGRCC_NO",LOW_REF:40,HIGH_REF:140,LOW_IN:"5",HIGH_IN:"95"};return[{id:1,location:"Parameter",mode:"Input",comment:"Normalization: Min-Max",unit:"",name:"NORMALIZE_OPT",isEnabled:!0},{id:2,location:"Constant",mode:"Input",comment:"Input low log value (P5)",unit:"",name:"LOW_IN",isEnabled:!0},{id:3,location:"Constant",mode:"Input",comment:"Input high log value (P95)",unit:"",name:"HIGH_IN",isEnabled:!0},{id:4,location:"Constant",mode:"Input",comment:"Reference log low value",unit:"",name:"LOW_REF",isEnabled:!0},{id:5,location:"Constant",mode:"Input",comment:"Reference log high value",unit:"",name:"HIGH_REF",isEnabled:!0},{id:6,location:"Log",mode:"Input",comment:"Input Log",unit:"",name:"LOG_IN",isEnabled:!0},{id:7,location:"Log",mode:"Output",comment:"Output Log Name",unit:"",name:"LOG_OUT",isEnabled:!0}].map(a=>({...a,values:e(t[a.name]||"")}))};function m(){let e=(0,r.useRouter)(),[t,a]=(0,s.useState)(d()),[n,m]=(0,s.useState)(!1),[u,h]=(0,s.useState)(!1),[b,p]=(0,s.useState)([]),[g,x]=(0,s.useState)([]),[f,N]=(0,s.useState)([]),[y,j]=(0,s.useState)(!0),{wellsDir:v,wellFolder:w,fieldName:_,structureName:I}=(0,i.m)();(0,s.useEffect)(()=>{(async()=>{j(!0);let e=c.env.NEXT_PUBLIC_API_URL;try{let t=await fetch("".concat(e,"/api/well-folder-files/").concat(_,"/").concat(I,"/").concat(w));if(!t.ok)throw Error("Gagal mengambil daftar file.");let a=await t.json();p(a.csv_files||[])}catch(e){console.error(e)}finally{j(!1)}})()},[w,_,I]);let O=(0,s.useCallback)(e=>e.map(e=>"data/structures/".concat(_,"/").concat(I,"/").concat(w,"/").concat(e)),[_,I,w]);(0,s.useEffect)(()=>{(async()=>{if(0===g.length)return N([]);let e=c.env.NEXT_PUBLIC_API_URL;try{let t=O(g),a=await fetch("".concat(e,"/api/get-well-columns"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_paths:t})});if(!a.ok)throw Error("Gagal mengambil kolom.");let l=await a.json(),s=Object.values(l).flat();N([...new Set(s)])}catch(e){console.error(e)}})()},[O,g,v]);let E=(0,s.useMemo)(()=>{var e;return null==(e=t.find(e=>"LOG_IN"===e.name))?void 0:e.values.default},[t]);(0,s.useEffect)(()=>{let e=async e=>{if(0===g.length||!e)return;h(!0);let t=c.env.NEXT_PUBLIC_API_URL;try{let l=await fetch("".concat(t,"/api/get-log-percentiles"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_paths:O(g),selected_intervals:[],log_column:e})});if(!l.ok){let e=await l.json();throw Error(e.error||"Gagal mengambil persentil dari backend.")}let s=await l.json();a(e=>e.map(e=>"LOW_IN"===e.name?{...e,values:{default:s.p5}}:"HIGH_IN"===e.name?{...e,values:{default:s.p95}}:e))}catch(e){console.error(e)}finally{h(!1)}};E&&e(E)},[g,E,O]),(0,s.useEffect)(()=>{E&&a(e=>e.map(e=>"LOG_OUT"===e.name?{...e,values:{default:"".concat(E,"_NO")}}:e))},[E]);let L=e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},S=(e,t)=>{a(a=>a.map(a=>a.id===e?{...a,values:{default:t}}:a))},C=async a=>{a.preventDefault(),m(!0);let l={params:t.filter(e=>e.isEnabled).reduce((e,t)=>{let a=t.values.default;return e[t.name]=a,e},{}),file_paths:O(g),selected_intervals:[]},s=c.env.NEXT_PUBLIC_API_URL;try{let t=await fetch("".concat(s,"/api/run-interval-normalization"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!t.ok)throw Error((await t.json()).error||"Server error");let a=await t.json();alert(a.message||"Proses normalisasi berhasil!"),e.push("/data-prep")}catch(e){alert("Error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{m(!1)}},k=(e,t)=>{switch(e){case"Parameter":return"bg-orange-600";case"Constant":return"Input"===t?"bg-yellow-300":"bg-yellow-100";case"Log":return"Input"===t?"bg-cyan-400":"bg-cyan-200";case"Output":return"bg-yellow-600";case"Interval":return"bg-green-400";default:return"bg-white"}};return(0,l.jsxs)("div",{className:"p-4 md:p-6 h-full flex flex-col bg-white rounded-lg shadow-md",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 flex-shrink-0",children:"Data Prep: Normalization"}),(0,l.jsxs)("div",{className:"mb-6 p-4 border rounded-lg bg-gray-50",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select File(s) for Normalization"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Files from: `",".../".concat(I,"/").concat(w),"`"]}),y?(0,l.jsx)(o.A,{className:"animate-spin"}):(0,l.jsx)("div",{className:"max-h-40 overflow-y-auto grid grid-cols-2 md:grid-cols-3 gap-2 border p-2 rounded-md bg-white",children:b.map(e=>(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm truncate p-1 rounded hover:bg-gray-100",children:[(0,l.jsx)("input",{type:"checkbox",checked:g.includes(e),onChange:()=>L(e),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e]},e))})]}),(0,l.jsxs)("form",{onSubmit:C,className:"flex-grow flex flex-col min-h-0",children:[(0,l.jsx)("div",{className:"flex-shrink-0 mb-6 p-4 border rounded-lg bg-gray-50",children:(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>e.back(),className:"px-6 py-2 rounded-md text-gray-800 bg-gray-200 hover:bg-gray-300 font-semibold",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md text-white font-semibold bg-blue-600 hover:bg-blue-700 flex items-center justify-center min-w-[80px]",disabled:n||u||0===g.length,children:n||u?(0,l.jsx)(o.A,{className:"animate-spin"}):"Start"})]})}),(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:"Parameters"}),(0,l.jsx)("div",{className:"flex-grow min-h-0 border border-gray-300 rounded-lg",children:(0,l.jsx)("div",{className:"overflow-auto h-full",children:(0,l.jsxs)("table",{className:"min-w-full text-sm table-auto",children:[(0,l.jsx)("thead",{className:"bg-gray-200 sticky top-0 z-10",children:(0,l.jsx)("tr",{children:["Location","Mode","Comment","Unit","Name","Value"].map(e=>(0,l.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r",children:e},e))})}),(0,l.jsx)("tbody",{className:"bg-white",children:t.map(e=>{var t,a;return(0,l.jsxs)("tr",{className:"border-b border-gray-200 ".concat(e.isEnabled?k(e.location,e.mode):"bg-gray-100 text-gray-400"),children:[(0,l.jsx)("td",{className:"px-3 py-2 border-r",children:e.location}),(0,l.jsx)("td",{className:"px-3 py-2 border-r",children:e.mode}),(0,l.jsx)("td",{className:"px-3 py-2 border-r",children:e.comment}),(0,l.jsx)("td",{className:"px-3 py-2 border-r",children:e.unit}),(0,l.jsx)("td",{className:"px-3 py-2 border-r font-semibold",children:e.name}),(0,l.jsx)("td",{className:"px-3 py-2 border-r bg-white text-black",children:"LOG_IN"===e.name?(0,l.jsx)("select",{value:null!=(t=e.values.default)?t:"",onChange:t=>S(e.id,t.target.value),className:"w-full p-1 bg-white",disabled:0===f.length,children:f.length>0?f.map(e=>(0,l.jsx)("option",{value:e,children:e},e)):(0,l.jsx)("option",{children:"Select a file first"})}):(0,l.jsx)("input",{type:"text",value:null!=(a=e.values.default)?a:"",onChange:t=>S(e.id,t.target.value),className:"w-full min-w-[100px] p-1 bg-white"})})]},e.id)})})]})})})]})]})}var u=a(3483),h=a(6252),b=a(9521),p=a(6850),g=a(9509);let x=()=>{let e=e=>({default:e}),t={METHOD:"MOVING_AVG",WINDOW:5,LOG_IN:"GR",LOG_OUT:"GR_SM"};return[{id:1,location:"Parameter",mode:"Input",comment:"Smoothing method",unit:"",name:"METHOD",isEnabled:!0},{id:2,location:"Parameter",mode:"Input",comment:"Size of smooth window (odd number)",unit:"",name:"WINDOW",isEnabled:!0},{id:3,location:"Log",mode:"Input",comment:"Log to be smoothed",unit:"",name:"LOG_IN",isEnabled:!0},{id:4,location:"Log",mode:"Output",comment:"Smoothed log name",unit:"",name:"LOG_OUT",isEnabled:!0}].map(a=>({...a,values:e(t[a.name]||"")}))};function f(){let e=(0,r.useRouter)(),[t,a]=(0,s.useState)(x()),[n,c]=(0,s.useState)(!1),[d,m]=(0,s.useState)([]),[u,h]=(0,s.useState)([]),[b,p]=(0,s.useState)([]),[f,N]=(0,s.useState)(!0),{fieldName:y,structureName:j,wellFolder:v}=(0,i.m)();(0,s.useEffect)(()=>{(async()=>{N(!0);let e=g.env.NEXT_PUBLIC_API_URL;try{let t=await fetch("".concat(e,"/api/well-folder-files/").concat(y,"/").concat(j,"/").concat(v));if(!t.ok)throw Error("Gagal mengambil daftar file.");let a=await t.json();m(a.csv_files||[])}catch(e){console.error(e)}finally{N(!1)}})()},[]);let w=(0,s.useCallback)(e=>e.map(e=>"data/structures/".concat(y,"/").concat(j,"/").concat(v,"/").concat(e)),[y,j,v]);(0,s.useEffect)(()=>{(async()=>{if(0===u.length)return p([]);let e=g.env.NEXT_PUBLIC_API_URL;try{let t=w(u),a=await fetch("".concat(e,"/api/get-well-columns"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_paths:t})});if(!a.ok)throw Error("Gagal mengambil kolom.");let l=await a.json(),s=Object.values(l).flat(),n=[...new Set(s)];p(n)}catch(e){console.error(e)}})()},[u,w]);let _=(0,s.useMemo)(()=>{var e;return null==(e=t.find(e=>"LOG_IN"===e.name))?void 0:e.values.default},[t]);(0,s.useEffect)(()=>{_&&a(e=>e.map(e=>"LOG_OUT"===e.name?{...e,values:{default:"".concat(_,"_SM")}}:e))},[_]);let I=e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},O=(e,t)=>{a(a=>a.map(a=>a.id===e?{...a,values:{default:t}}:a))},E=async a=>{a.preventDefault(),c(!0);let l={params:t.filter(e=>e.isEnabled).reduce((e,t)=>(e[t.name]=t.values.default,e),{}),file_paths:w(u),selected_intervals:[]},s=g.env.NEXT_PUBLIC_API_URL;try{let t=await fetch("".concat(s,"/api/run-smoothing"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!t.ok)throw Error((await t.json()).error||"Server error");let a=await t.json();alert(a.message||"Proses smoothing berhasil!"),e.push("/data-prep")}catch(e){alert("Error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{c(!1)}},L=(e,t)=>{switch(e){case"Parameter":return"bg-orange-600";case"Log":return"Input"===t?"bg-cyan-400":"bg-cyan-200";default:return"bg-white"}};return(0,l.jsxs)("div",{className:"p-4 md:p-6 h-full flex flex-col bg-white rounded-lg shadow-md",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 flex-shrink-0",children:"Data Prep: Smoothing"}),(0,l.jsxs)("div",{className:"mb-6 p-4 border rounded-lg bg-gray-50",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select File(s) for Smoothing"}),(0,l.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Files from: `",".../".concat(j,"/").concat(v),"`"]}),f?(0,l.jsx)(o.A,{className:"animate-spin"}):(0,l.jsx)("div",{className:"max-h-40 overflow-y-auto grid grid-cols-2 md:grid-cols-3 gap-2 border p-2 rounded-md bg-white",children:d.map(e=>(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm truncate p-1 rounded hover:bg-gray-100",children:[(0,l.jsx)("input",{type:"checkbox",checked:u.includes(e),onChange:()=>I(e),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e]},e))})]}),(0,l.jsxs)("form",{onSubmit:E,className:"flex-grow flex flex-col min-h-0",children:[(0,l.jsx)("div",{className:"flex-shrink-0 mb-6 p-4 border rounded-lg bg-gray-50",children:(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>e.back(),className:"px-6 py-2 rounded-md text-gray-800 bg-gray-200 hover:bg-gray-300 font-semibold",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",className:"px-6 py-2 rounded-md text-white font-semibold bg-blue-600 hover:bg-blue-700 flex items-center justify-center min-w-[80px]",disabled:n||0===u.length,children:n?(0,l.jsx)(o.A,{className:"animate-spin"}):"Start"})]})}),(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:"Parameters"}),(0,l.jsx)("div",{className:"flex-grow min-h-0 border border-gray-300 rounded-lg",children:(0,l.jsx)("div",{className:"overflow-auto h-full",children:(0,l.jsxs)("table",{className:"min-w-full text-sm table-auto",children:[(0,l.jsx)("thead",{className:"bg-gray-200 sticky top-0 z-10",children:(0,l.jsx)("tr",{children:["#","Location","Mode","Comment","Name","Value"].map(e=>(0,l.jsx)("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-b border-r",children:e},e))})}),(0,l.jsx)("tbody",{className:"bg-white",children:t.map(e=>{var t,a,s;return(0,l.jsxs)("tr",{className:"border-b border-gray-200 ".concat(e.isEnabled?L(e.location,e.mode):"bg-gray-100 text-gray-400"),children:[(0,l.jsx)("td",{className:"px-3 py-2 border-r text-center",children:e.id}),(0,l.jsx)("td",{className:"px-3 py-2 border-r",children:e.location}),(0,l.jsx)("td",{className:"px-3 py-2 border-r",children:e.mode}),(0,l.jsx)("td",{className:"px-3 py-2 border-r",children:e.comment}),(0,l.jsx)("td",{className:"px-3 py-2 border-r font-semibold",children:e.name}),(0,l.jsx)("td",{className:"px-3 py-2 border-r bg-white text-black",children:"LOG_IN"===e.name?(0,l.jsx)("select",{value:null!=(t=e.values.default)?t:"",onChange:t=>O(e.id,t.target.value),className:"w-full p-1 bg-white",disabled:0===b.length,children:b.length>0?b.map(e=>(0,l.jsx)("option",{value:e,children:e},e)):(0,l.jsx)("option",{children:"Select a file first"})}):"METHOD"===e.name?(0,l.jsx)("select",{value:null!=(a=e.values.default)?a:"",onChange:t=>O(e.id,t.target.value),className:"w-full p-1 bg-white",children:(0,l.jsx)("option",{value:"MOVING_AVG",children:"MOVING_AVG"})}):(0,l.jsx)("input",{type:"text",value:null!=(s=e.values.default)?s:"",onChange:t=>O(e.id,t.target.value),className:"w-full min-w-[100px] p-1 bg-white"})})]},e.id)})})]})})})]})]})}let N=e=>{let{moduleName:t,validModules:a}=e;if(!a.includes(t))return(0,l.jsx)("div",{className:"h-full p-4 md:p-6 bg-gray-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-red-200",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,l.jsx)(n.A,{className:"w-6 h-6 text-red-500"}),(0,l.jsx)("h1",{className:"text-xl font-semibold text-red-700",children:"Module Not Found"})]}),(0,l.jsxs)("p",{className:"text-gray-600 mb-4",children:['The data preparation module "',t,'" could not be found.']}),(0,l.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-red-800 mb-2",children:"Available modules:"}),(0,l.jsx)("ul",{className:"list-disc list-inside text-sm text-red-700 space-y-1",children:a.map(e=>(0,l.jsx)("li",{children:e},e))})]})]})});switch(t){case"trim-data":return(0,l.jsx)(u.A,{});case"normalization":return(0,l.jsx)(m,{});case"depth-matching":return(0,l.jsx)(h.A,{});case"fill-missing":return(0,l.jsx)(b.A,{});case"smoothing":return(0,l.jsx)(f,{});case"splicing-merging":return(0,l.jsx)(p.A,{});default:return(0,l.jsx)("div",{className:"h-full p-4 md:p-6 bg-gray-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:t.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}),(0,l.jsx)("p",{className:"text-gray-600",children:"This module is under development."})]})})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[9,379,597,441,684,358],()=>t(2874)),_N_E=e.O()}]);